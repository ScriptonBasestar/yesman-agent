# DevOps & Infrastructure Monitoring
# Complete setup for DevOps workflows and infrastructure monitoring

session_name: "devops-infrastructure"
description: "DevOps tooling and infrastructure monitoring"

# Workspace for DevOps and infrastructure
workspace_config:
  base_dir: "~/projects/infrastructure"

workspace_definitions:
  terraform:
    rel_dir: "./terraform"
    allowed_paths:
      - "."
      - "./modules"
      - "./environments"
    description: "Terraform infrastructure as code"
    
  ansible:
    rel_dir: "./ansible"
    allowed_paths:
      - "."
      - "./playbooks"
      - "./roles"
      - "./inventory"
    description: "Ansible configuration management"
    
  kubernetes:
    rel_dir: "./k8s"
    allowed_paths:
      - "."
      - "./manifests"
      - "./helm"
    description: "Kubernetes manifests and Helm charts"
    
  monitoring:
    rel_dir: "./monitoring"
    allowed_paths:
      - "."
      - "./grafana"
      - "./prometheus"
      - "./logs"
    description: "Monitoring and observability configs"

# DevOps environment setup  
before_script: |
  echo "üöÄ Setting up DevOps environment..."
  
  # Install tools if needed
  which terraform || echo "‚ö†Ô∏è Please install Terraform"
  which ansible || echo "‚ö†Ô∏è Please install Ansible"  
  which kubectl || echo "‚ö†Ô∏è Please install kubectl"
  which helm || echo "‚ö†Ô∏è Please install Helm"
  
  # Initialize Terraform if needed
  if [ -d "terraform" ]; then
    cd terraform && terraform init && cd ..
  fi
  
  echo "‚úÖ DevOps environment ready!"

environment:
  TERRAFORM_LOG: "INFO"
  ANSIBLE_HOST_KEY_CHECKING: "False"
  KUBECONFIG: "~/.kube/config"
  HELM_CACHE_HOME: "~/.cache/helm"

logging:
  level: "INFO" 
  file: "~/.scripton/yesman/logs/devops.log"
  format: "%(asctime)s [%(levelname)s] %(name)s: %(message)s"

# Custom DevOps settings
custom:
  project:
    type: "devops"
    auto_backup: true
    backup_paths: ["./terraform", "./k8s", "./monitoring"]
    
  integrations:
    terraform: true
    ansible: true
    kubernetes: true
    monitoring: true