# Django Development Configuration
# Production-ready setup for Django web applications

session_name: "django-webapp"
description: "Django development with database and testing"

# Workspace configuration for Django project structure
workspace_config:
  base_dir: "~/projects/django-app"

workspace_definitions:
  backend:
    rel_dir: "."
    allowed_paths:
      - "."
      - "./apps"
      - "./config"
      - "./tests"
      - "./static"
      - "./media"
      - "./templates"
    description: "Django backend workspace"
    
  frontend:
    rel_dir: "./frontend"
    allowed_paths:
      - "."
      - "./src"
      - "./static"
      - "./templates"
    description: "Frontend assets workspace"

# Django environment setup
before_script: |
  echo "üêç Setting up Django environment..."
  
  # Activate virtual environment
  if [ -f "venv/bin/activate" ]; then
    source venv/bin/activate
  elif [ -f ".venv/bin/activate" ]; then
    source .venv/bin/activate
  fi
  
  # Install dependencies
  pip install -r requirements.txt || pip install -r requirements/dev.txt || true
  
  # Run migrations
  python manage.py migrate || true
  
  # Start services if available
  docker-compose -f docker-compose.dev.yml up -d postgres redis || true
  
  echo "‚úÖ Django environment ready!"

environment:
  DJANGO_ENV: "development"
  DEBUG: "True"
  DATABASE_URL: "postgresql://localhost:5432/django_dev"
  REDIS_URL: "redis://localhost:6379/0"
  CELERY_BROKER_URL: "redis://localhost:6379/0"

logging:
  level: "INFO"
  file: "~/.scripton/yesman/logs/django-dev.log"
  format: "%(asctime)s [%(levelname)s] %(name)s: %(message)s"

# Custom Django settings
custom:
  project:
    type: "django"
    auto_migrate: true
    collect_static: false
    
  integrations:
    celery: true
    redis: true
    postgresql: true